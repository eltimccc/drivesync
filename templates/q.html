<!DOCTYPE html>
<html lang="en">
<head>
<style>
    .table {
        width: 100%; /* Занимает всю ширину контейнера */
        border-collapse: collapse; /* Убирает двойные границы между ячейками */
    }

    .table, .table th, .table td {
        border: 1px solid black; /* Добавляет границы для таблицы, заголовков и ячеек */
    }

    .table th, .table td {
        padding: 8px; /* Добавляет отступы внутри ячеек */
        text-align: left; /* Выравнивание текста в ячейках */
    }

    .table th {
        background-color: #f2f2f2; /* Цвет фона для заголовков таблицы */
    }
</style>
</head>
<body>
<div class="container">
    <div class="year">
        {{ current_year }}
    </div>
    <div class="month">
        {{ current_month }}
    </div>
    <div class="table-wrapper" id="table-wrapper">
        <table class="table table-striped">
            <thead>
            <tr id="calendar-header">
                <th>Автомобили</th>
                {% for date in dates %}
                <th {% if date == today.strftime("%a, %d, %Y ") %}class="today"{% endif %}>{{ date }}</th>
                {% endfor %}
            </tr>
            </thead>
            <tbody id="table-body">
            {% for car in cars %}
            <tr>
                <td>{{ car }}</td>
                {% for date in dates %}
                <td></td>
                {% endfor %}
            </tr>
            {% endfor %}
            </tbody>
        </table>
    </div>
</div>





<!-- Скрипт Bootstrap и jQuery для взаимодействия с прокруткой -->
<script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.5.4/dist/umd/popper.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>

<!-- Наш кастомный скрипт для прокрутки -->
<script>
$(document).ready(function() {
    // Функция для обновления года и месяца
    function updateYearAndMonth() {
        // Находим видимые ячейки заголовка таблицы
        var visibleThs = $('#table-wrapper th').filter(function() {
            var $th = $(this);
            var thOffset = $th.offset().left;
            var scrollWrapperOffset = $('#table-wrapper').offset().left;
            var scrollWrapperWidth = $('#table-wrapper').width();
            // Проверяем, видна ли ячейка
            return thOffset >= scrollWrapperOffset && thOffset <= (scrollWrapperOffset + scrollWrapperWidth);
        });

        if (visibleThs.length > 0) {
            // Берём дату из первой видимой ячейки
            var firstVisibleDate = $(visibleThs[0]).text().trim();
            var dateParts = firstVisibleDate.split('-'); // Предполагается формат YYYY-MM-DD

            if (dateParts.length === 3) {
                var year = dateParts[0];
                var month = dateParts[1];

                // Обновляем содержимое .year и .month
                $('.year').text(year);
                $('.month').text(month); // Здесь можно добавить логику для преобразования номера месяца в название
            }
        }
    }

    // Вызываем функцию при первой загрузке страницы
    updateYearAndMonth();

    // Обновляем год и месяц при прокрутке
    $('#table-wrapper').scroll(function() {
        updateYearAndMonth();
    });
});
</script>

<script>
    function scrollBack() {
        document.getElementById('table-wrapper').scrollLeft -= 100; // Изменяем значение в соответствии с вашими потребностями
    }
    
    function scrollForward() {
        document.getElementById('table-wrapper').scrollLeft += 100; // Изменяем значение в соответствии с вашими потребностями
    }

    // Функция для нахождения текущей даты в таблице и прокрутки к ней
    function scrollToCurrentDate() {
        var currentDateCell = document.querySelector('th.today');
        if (currentDateCell) {
            var tableWrapper = document.getElementById('table-wrapper');
            tableWrapper.scrollLeft = currentDateCell.offsetLeft - tableWrapper.clientWidth / 2; // Центрируем текущую дату по горизонтали
        }
    }

    // Вызываем функцию при загрузке страницы
    window.onload = function() {
        scrollToCurrentDate();
    };
</script>


</body>
</html>
